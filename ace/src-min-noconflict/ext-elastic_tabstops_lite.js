ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],function(e,t){var i=function(e){this.$editor=e;var t=this,i=[],n=!1;this.onAfterExec=function(){n=!1,t.processRows(i),i=[]},this.onExec=function(){n=!0},this.onChange=function(e){var t=e.data.range;n&&(-1==i.indexOf(t.start.row)&&i.push(t.start.row),t.end.row!=t.start.row&&i.push(t.end.row))}};!function(){this.processRows=function(e){this.$inChange=!0;for(var t=[],i=0,n=e.length;n>i;i++){var r=e[i];if(!(t.indexOf(r)>-1))for(var o=this.$findCellWidthsForBlock(r),s=this.$setBlockCellWidthsToMax(o.cellWidths),u=o.firstRow,a=0,l=s.length;l>a;a++){var c=s[a];t.push(u),this.$adjustRow(u,c),u++}}this.$inChange=!1},this.$findCellWidthsForBlock=function(e){for(var t,i=[],n=e;n>=0&&(t=this.$cellWidthsForRow(n),0!=t.length);)i.unshift(t),n--;var r=n+1;n=e;for(var o=this.$editor.session.getLength();o-1>n&&(n++,t=this.$cellWidthsForRow(n),0!=t.length);)i.push(t);return{cellWidths:i,firstRow:r}},this.$cellWidthsForRow=function(e){for(var t=this.$selectionColumnsForRow(e),i=[-1].concat(this.$tabsForRow(e)),n=i.map(function(){return 0}).slice(1),r=this.$editor.session.getLine(e),o=0,s=i.length-1;s>o;o++){var u=i[o]+1,a=i[o+1],l=this.$rightmostSelectionInCell(t,a),c=r.substring(u,a);n[o]=Math.max(c.replace(/\s+$/g,"").length,l-u)}return n},this.$selectionColumnsForRow=function(e){var t=[],i=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&e==i.row&&t.push(i.column),t},this.$setBlockCellWidthsToMax=function(e){for(var t,i,n,r=!0,o=this.$izip_longest(e),s=0,u=o.length;u>s;s++){var a=o[s];if(a.push){a.push(0/0);for(var l=0,c=a.length;c>l;l++){var h=a[l];if(r&&(t=l,n=0,r=!1),isNaN(h)){i=l;for(var d=t;i>d;d++)e[d][s]=n;r=!0}n=Math.max(n,h)}}else console.error(a)}return e},this.$rightmostSelectionInCell=function(e,t){var i=0;if(e.length){for(var n=[],r=0,o=e.length;o>r;r++)e[r]<=t?n.push(r):n.push(0);i=Math.max.apply(Math,n)}return i},this.$tabsForRow=function(e){for(var t,i=[],n=this.$editor.session.getLine(e),r=/\t/g;null!=(t=r.exec(n));)i.push(t.index);return i},this.$adjustRow=function(e,t){var i=this.$tabsForRow(e);if(0!=i.length)for(var n=0,r=-1,o=this.$izip(t,i),s=0,u=o.length;u>s;s++){var a=o[s][0],l=o[s][1];r+=1+a,l+=n;var c=r-l;if(0!=c){var h=this.$editor.session.getLine(e).substr(0,l),d=h.replace(/\s*$/g,""),g=h.length-d.length;c>0&&(this.$editor.session.getDocument().insertInLine({row:e,column:l+1},Array(c+1).join(" ")+"	"),this.$editor.session.getDocument().removeInLine(e,l,l+1),n+=c),0>c&&g>=-c&&(this.$editor.session.getDocument().removeInLine(e,l+c,l),n+=c)}}},this.$izip_longest=function(e){if(!e[0])return[];for(var t=e[0].length,i=e.length,n=1;i>n;n++){var r=e[n].length;r>t&&(t=r)}for(var o=[],s=0;t>s;s++){for(var u=[],n=0;i>n;n++)""===e[n][s]?u.push(0/0):u.push(e[n][s]);o.push(u)}return o},this.$izip=function(e,t){for(var i=e.length>=t.length?t.length:e.length,n=[],r=0;i>r;r++){var o=[e[r],t[r]];n.push(o)}return n}}.call(i.prototype),t.ElasticTabstopsLite=i;var n=e("../editor").Editor;e("../config").defineOptions(n.prototype,"editor",{useElasticTabstops:{set:function(e){e?(this.elasticTabstops||(this.elasticTabstops=new i(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})});